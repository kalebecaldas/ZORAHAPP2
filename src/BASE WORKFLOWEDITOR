Aqui estÃ¡ um **GUIA COMPLETO** para vocÃª criar **um fluxograma Mermaid** baseado no fluxo *correto* do seu projeto â€” **exatamente como vocÃª descreveu agora**.

Esse guia serve tanto para vocÃª **mesmo escrever** o diagrama quanto para gerar via IA.

---

# ğŸ§­ **GUIA DEFINITIVO PARA CRIAR UM FLUXOGRAMA MERMAID

(Baseado no seu fluxo real de atendimento clÃ­nico)**

## ğŸ“Œ **1. Estrutura bÃ¡sica que TODO fluxograma Mermaid precisa**

Sempre comece com:

```mermaid
flowchart TD
```

Ou, se preferir horizontal:

```mermaid
flowchart LR
```

* **TD = Top â†’ Down (vertical)**
* **LR = Left â†’ Right (horizontal)**

---

# ğŸ§± **2. OrganizaÃ§Ã£o das grandes fases do seu fluxo**

Seu fluxo tem **4 fases principais**:

1. **Escolha da unidade**
2. **Loop de informaÃ§Ãµes**
3. **Entrada no agendamento**
4. **Processo completo de agendamento**

EntÃ£o precisamos quebrar assim:

```
INÃCIO  
â†’ Escolha da unidade  
â†’ Loop de perguntas  
â†’ DecisÃ£o: agendar?  
â†’ (se sim) fluxo de agendamento  
```

---

# ğŸ” **3. Como mapear o LOOP de perguntas no Mermaid**

O loop sempre volta para â€œGPT Identifica IntenÃ§Ã£oâ€.

As intenÃ§Ãµes possÃ­veis sÃ£o:

* localizaÃ§Ã£o da unidade
* convÃªnios atendidos
* procedimentos cobertos por um convÃªnio
* valores particulares
* explicaÃ§Ã£o do procedimento (benefÃ­cios + pacotes + resumo)
* perguntas livres (opcional)
* AGENDAR

EntÃ£o no Mermaid criamos algo assim:

```mermaid
GPT --> Localizacao --> GPT
GPT --> Convenios --> GPT
GPT --> Valores --> GPT
GPT --> ProcedimentoInfo --> GPT
GPT --> Agendar
```

---

# ğŸ§© **4. Regras especÃ­ficas que precisam estar no fluxo**

### **4.1 Escolher unidade**

* paciente escolhe 1 unidade cadastrada
* essa escolha define:

  * localizaÃ§Ã£o a mostrar
  * convÃªnios disponÃ­veis
  * procedimentos daquela unidade

### **4.2 InformaÃ§Ãµes dinÃ¢micas**

Sempre puxar do banco:

* para valores particulares â†’ usar â€œprocedimento marcado como particularâ€
* ao explicar um procedimento:

  * valor particular
  * pacotes
  * resumo + benefÃ­cios

### **4.3 O loop sÃ³ termina se o paciente disser que quer agendar**

Isso precisa estar explÃ­cito.

---

# ğŸ§¾ **5. Fluxo de Agendamento (detalhado)**

1. Verificar se tem cadastro

   * se nÃ£o, solicitar:

     * nome completo
     * data de nascimento
     * CPF
     * e-mail
     * convÃªnio
   * confirmar cadastro (mostrar tudo de volta)
2. Pedir procedimento (atÃ© **3**)
3. Pedir data
4. Pedir turno

   * manhÃ£: 07:30â€“12:00
   * tarde: 13:30â€“17:00
   * noite: 17:00â€“19:30
5. Confirmar prÃ©-agendamento
6. Enviar para fila â€œAguardandoâ€

---

# ğŸ§  **6. Agora sim: modelo para vocÃª usar como â€œprompt padrÃ£oâ€ para gerar Mermaid**

Aqui estÃ¡ o **modelo completo**, pronto para copiar:

---

# âœ… **GUIA + TEMPLATE PARA GERAR O FLUXOGRAMA MERMAID**

```markdown
Quero gerar um fluxograma Mermaid com o seguinte fluxo:

flowchart TD

1) INÃCIO DO ATENDIMENTO
- O paciente entra em contato
- O bot exibe as unidades cadastradas
- O paciente escolhe uma unidade

2) LOOP DE INFORMAÃ‡Ã•ES (GPT identifica intenÃ§Ã£o)
O bot deve voltar para o nÃ³ â€œGPT_Intencaoâ€ apÃ³s cada resposta.
As intenÃ§Ãµes possÃ­veis sÃ£o:

A) Perguntar sobre CONVÃŠNIOS atendidos
   - Buscar convÃªnios da unidade escolhida
   - Retornar convÃªnios
   - Se perguntar sobre procedimentos do convÃªnio:
       â†’ retornar apenas procedimentos cobertos

B) Perguntar sobre LOCALIZAÃ‡ÃƒO
   - Trazer endereÃ§o da unidade escolhida

C) Perguntar sobre VALORES
   - Retornar valor PARTICULAR do procedimento
   - Buscar procedimentos marcados como â€œparticularâ€
   - Se houver pacotes â†’ trazer tambÃ©m

D) Perguntar sobre um PROCEDIMENTO (ex: acupuntura)
   - Trazer:
       â€¢ O que Ã©
       â€¢ BenefÃ­cios
       â€¢ Valores (particular)
       â€¢ Pacotes
       â€¢ Resumo curto
   - Tudo numa mensagem Ãºnica

E) InformaÃ§Ãµes gerais
   - Responder e voltar ao loop

F) AGENDAR
   - Sai do loop

3) FLUXO DE AGENDAMENTO

3.1 Verificar cadastro
   - Se tem â†’ continuar
   - Se nÃ£o tem:
       â€¢ Pedir Nome
       â€¢ Data de nascimento
       â€¢ CPF
       â€¢ Email
       â€¢ ConvÃªnio
       â€¢ Confirmar cadastro mostrando os dados
       â€¢ ApÃ³s confirmar â†’ seguir para agendamento

3.2 Perguntar PROCEDIMENTOS
   - Pode escolher atÃ© 3
   - Pode parar antes se desejar

3.3 Perguntar DATA
   - Mostrar datas disponÃ­veis
   - Permitir escolher a desejada

3.4 Perguntar TURNO
   - ManhÃ£: 07:30â€“12:00
   - Tarde: 13:30â€“17:00
   - Noite: 17:00â€“19:30

3.5 Confirmar PRÃ‰-AGENDAMENTO
   - Mostrar tudo:
       â€¢ Unidade
       â€¢ ConvÃªnio
       â€¢ Procedimentos
       â€¢ Data
       â€¢ Turno
       â€¢ HorÃ¡rio
   - Se confirmar â†’ Fila Aguardando

4) FIM

Com base nessas regras, gere um fluxograma Mermaid completo que:
- tenha nÃ³s nomeados
- mostre loops
- mostre decisÃµes
- destaque claramente a transiÃ§Ã£o para o agendamento
```

---
