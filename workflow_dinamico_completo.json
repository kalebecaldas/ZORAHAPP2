{
  "name": "Sistema Multi-Cl√≠nica Din√¢mico",
  "description": "Workflow completo que carrega dados de cl√≠nicas, conv√™nios e procedimentos diretamente do banco de dados",
  "isActive": true,
  "nodes": [
    {
      "id": "start",
      "type": "START",
      "position": { "x": 100, "y": 50 },
      "data": {
        "message": "Ol√°! Em qual unidade voc√™ gostaria de ser atendido(a)?\n1Ô∏è‚É£ Unidade Vieiralves üìç Rua Rio I√ß√°, 850 ‚Äî Nossa Sra. das Gra√ßas\n2Ô∏è‚É£ Unidade S√£o Jos√© üìç Av. Autaz Mirim, 5773 ‚Äî S√£o Jos√© Oper√°rio\n\nResponda com 1 ou 2, ou digite o nome da unidade."
      }
    },
    {
      "id": "clinic_selection",
      "type": "CONDITION",
      "position": { "x": 100, "y": 150 },
      "data": {
        "condition": "clinic_selection",
        "trueMessage": "√ìtima escolha! Agora, em que posso ajudar voc√™?",
        "falseMessage": "Por favor, escolha uma de nossas unidades."
      }
    },
    {
      "id": "gpt_welcome",
      "type": "MESSAGE",
      "position": { "x": 100, "y": 230 },
      "data": {
        "message": "Voc√™ pode perguntar sobre consultas, nossos procedimentos ou conv√™nios. Se quiser agendar, diga que quer agendar."
      }
    },
    {
      "id": "service_menu",
      "type": "MESSAGE",
      "position": { "x": 100, "y": 250 },
      "data": {
        "message": "üìã Escolha uma op√ß√£o:
1Ô∏è‚É£ Valores de procedimentos
2Ô∏è‚É£ Conv√™nios aceitos
3Ô∏è‚É£ Localiza√ß√£o e hor√°rios
4Ô∏è‚É£ Agendar consulta
5Ô∏è‚É£ Falar com atendente"
      }
    },
    {
      "id": "service_selection",
      "type": "CONDITION",
      "position": { "x": 100, "y": 350 },
      "data": {
        "condition": "service_selection"
      }
    },
    {
      "id": "gpt_classifier",
      "type": "GPT_RESPONSE",
      "position": { "x": 100, "y": 320 },
      "data": {
        "systemPrompt": "Voc√™ √© um classificador de inten√ß√£o simples. Analise a mensagem do usu√°rio e encaminhe para: 1) valores de procedimentos, 2) conv√™nios, 3) localiza√ß√£o, 4) agendamento, 5) falar com atendente."
      }
    },
    {
      "id": "procedure_inquiry",
      "type": "MESSAGE",
      "position": { "x": -100, "y": 450 },
      "data": {
        "message": "üí∞ Qual procedimento voc√™ deseja consultar?
Exemplos: Fisioterapia, Acupuntura, RPG, Pilates"
      }
    },
    {
      "id": "procedure_response",
      "type": "API_CALL",
      "position": { "x": -100, "y": 550 },
      "data": {
        "endpoint": "get_clinic_procedures",
        "message": "Buscando valores para o procedimento solicitado..."
      }
    },
    {
      "id": "insurance_inquiry",
      "type": "MESSAGE",
      "position": { "x": 100, "y": 450 },
      "data": {
        "message": "Vou verificar os conv√™nios aceitos na unidade escolhida."
      }
    },
    {
      "id": "insurance_response",
      "type": "API_CALL",
      "position": { "x": 100, "y": 550 },
      "data": {
        "endpoint": "get_clinic_insurances",
        "message": "Buscando conv√™nios aceitos..."
      }
    },
    {
      "id": "location_inquiry",
      "type": "API_CALL",
      "position": { "x": 300, "y": 450 },
      "data": {
        "endpoint": "get_clinic_location",
        "message": "Buscando informa√ß√µes de localiza√ß√£o e hor√°rios..."
      }
    },
    {
      "id": "appointment_request",
      "type": "MESSAGE",
      "position": { "x": 500, "y": 450 },
      "data": {
        "message": "üóìÔ∏è Para agendar, informe:
‚Ä¢ üìÖ Data preferencial
‚Ä¢ üïê Hor√°rio preferencial
‚Ä¢ üìã Procedimento
‚Ä¢ üí≥ Conv√™nio ou particular"
      }
    },
    {
      "id": "appointment_collection",
      "type": "COLLECT_INFO",
      "position": { "x": 500, "y": 550 },
      "data": {
        "fields": ["procedure_type", "preferred_date", "preferred_time", "insurance"],
        "message": "Aguarde enquanto processo suas informa√ß√µes..."
      }
    },
    {
      "id": "human_transfer",
      "type": "MESSAGE",
      "position": { "x": 700, "y": 450 },
      "data": {
        "message": "Estou transferindo voc√™ para um de nossos atendentes. Por favor, aguarde um momento."
      }
    },
    {
      "id": "continue_conversation",
      "type": "MESSAGE",
      "position": { "x": 100, "y": 650 },
      "data": {
        "message": "‚ÑπÔ∏è Posso ajudar com mais alguma informa√ß√£o?"
      }
    },
    {
      "id": "end_conversation",
      "type": "END",
      "position": { "x": 100, "y": 750 },
      "data": {
        "message": "Obrigado por entrar em contato! Se precisar de mais alguma coisa, estarei aqui. Tenha um √≥timo dia!"
      }
    },
    {
      "id": "tmpl_prices",
      "type": "MESSAGE",
      "position": { "x": -300, "y": 520 },
      "data": {
        "message": "üí∞ Valores de Procedimentos\n\n‚Ä¢ Procedimento: ${procedimento_x}\n‚Ä¢ Valor: ${valor_procedimento}\n‚Ä¢ Dura√ß√£o: ${duracao_procedimento}\n‚Ä¢ Observa√ß√µes: ${observacao_procedimento}\n\nDeseja agendar este procedimento ou consultar outro?"
      }
    },
    {
      "id": "tmpl_insurance",
      "type": "MESSAGE",
      "position": { "x": 100, "y": 520 },
      "data": {
        "message": "üìã Conv√™nios\n\nConfirmamos atendimento ao conv√™nio ${convenio_x}.\n\nProcedimentos cobertos:\n1Ô∏è‚É£ ${procedimento_1}\n2Ô∏è‚É£ ${procedimento_2}\n3Ô∏è‚É£ ${procedimento_3}\n\nDeseja agendar ou consultar valores?"
      }
    },
    {
      "id": "tmpl_location",
      "type": "MESSAGE",
      "position": { "x": 300, "y": 520 },
      "data": {
        "message": "üìç Localiza√ß√£o e Hor√°rios\n\n‚Ä¢ Unidade: ${unidade_nome}\n‚Ä¢ Endere√ßo: ${endereco}\n‚Ä¢ Hor√°rio: ${horario_atendimento}\n‚Ä¢ Contato: ${telefone}\n‚Ä¢ Mapa: ${maps_url}\n\nDeseja agendar ou saber valores?"
      }
    }
  ],
  "connections": [
    {
      "id": "start_to_clinic",
      "source": "start",
      "sourcePort": "output",
      "target": "clinic_selection",
      "targetPort": "input"
    },
    {
      "id": "clinic_to_welcome",
      "source": "clinic_selection",
      "sourcePort": "true",
      "target": "gpt_welcome",
      "targetPort": "input"
    },
    {
      "id": "clinic_retry",
      "source": "clinic_selection",
      "sourcePort": "false",
      "target": "start",
      "targetPort": "input"
    },
    {
      "id": "welcome_to_classifier",
      "source": "gpt_welcome",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input"
    },
    {
      "id": "menu_to_service",
      "source": "service_menu",
      "sourcePort": "output",
      "target": "service_selection",
      "targetPort": "input"
    },
    {
      "id": "classifier_to_procedure",
      "source": "gpt_classifier",
      "sourcePort": "1",
      "target": "tmpl_prices",
      "targetPort": "input"
    },
    {
      "id": "classifier_to_insurance",
      "source": "gpt_classifier",
      "sourcePort": "2",
      "target": "tmpl_insurance",
      "targetPort": "input"
    },
    {
      "id": "classifier_to_location",
      "source": "gpt_classifier",
      "sourcePort": "3",
      "target": "tmpl_location",
      "targetPort": "input"
    },
    {
      "id": "classifier_to_appointment",
      "source": "gpt_classifier",
      "sourcePort": "4",
      "target": "appointment_request",
      "targetPort": "input"
    },
    {
      "id": "classifier_to_human",
      "source": "gpt_classifier",
      "sourcePort": "5",
      "target": "human_transfer",
      "targetPort": "input"
    },
    {
      "id": "service_to_procedure",
      "source": "service_selection",
      "sourcePort": "1",
      "target": "procedure_inquiry",
      "targetPort": "input"
    },
    {
      "id": "service_to_insurance",
      "source": "service_selection",
      "sourcePort": "2",
      "target": "insurance_inquiry",
      "targetPort": "input"
    },
    {
      "id": "service_to_location",
      "source": "service_selection",
      "sourcePort": "3",
      "target": "location_inquiry",
      "targetPort": "input"
    },
    {
      "id": "service_to_appointment",
      "source": "service_selection",
      "sourcePort": "4",
      "target": "appointment_request",
      "targetPort": "input"
    },
    {
      "id": "service_to_human",
      "source": "service_selection",
      "sourcePort": "5",
      "target": "human_transfer",
      "targetPort": "input"
    },
    {
      "id": "procedure_to_response",
      "source": "procedure_inquiry",
      "sourcePort": "output",
      "target": "procedure_response",
      "targetPort": "input"
    },
    {
      "id": "insurance_to_response",
      "source": "insurance_inquiry",
      "sourcePort": "output",
      "target": "insurance_response",
      "targetPort": "input"
    },
    {
      "id": "appointment_to_collection",
      "source": "appointment_request",
      "sourcePort": "output",
      "target": "appointment_collection",
      "targetPort": "input"
    },
    {
      "id": "procedure_to_classifier",
      "source": "procedure_response",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input"
    },
    {
      "id": "tmpl_prices_to_classifier",
      "source": "tmpl_prices",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input"
    },
    {
      "id": "insurance_to_classifier",
      "source": "insurance_response",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input"
    },
    {
      "id": "tmpl_insurance_to_classifier",
      "source": "tmpl_insurance",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input"
    },
    {
      "id": "location_to_classifier",
      "source": "location_inquiry",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input"
    },
    {
      "id": "tmpl_location_to_classifier",
      "source": "tmpl_location",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input"
    },
    {
      "id": "appointment_to_classifier",
      "source": "appointment_collection",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input"
    },
    {
      "id": "human_to_end",
      "source": "human_transfer",
      "sourcePort": "output",
      "target": "end_conversation",
      "targetPort": "input"
    },
    {
      "id": "continue_loop",
      "source": "continue_conversation",
      "sourcePort": "output",
      "target": "gpt_classifier",
      "targetPort": "input",
      "condition": "continue"
    },
    {
      "id": "continue_to_end",
      "source": "continue_conversation",
      "sourcePort": "output",
      "target": "end_conversation",
      "targetPort": "input",
      "condition": "end"
    }
  ]
}
